{% load static %}
<div class="container mt-4">
  <h2>Configuraciones de Pruebas del Laboratorio</h2>

  {% if messages %}
  <div>
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Contenedor de mensajes AJAX (después del bloque de mensajes de Django) -->
  <div id="ajax-messages"></div>
  <script>
    window.showGlobalMessage = function(type, text) {
      // type: 'success' | 'danger' | 'info' | 'warning'
      const box = document.getElementById('ajax-messages');
      if (!box) return;
      const alert = document.createElement('div');
      alert.className = `alert alert-${type}`;
      alert.textContent = text;
      box.innerHTML = '';
      box.appendChild(alert);
      setTimeout(() => { if (alert.parentNode) alert.remove(); }, 6000);
    }
  </script>

  <!-- Pruebas pendientes -->
  <h4>Pruebas pendientes por configurar</h4>
  {% if pending_pruebas %}
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Prueba</th>
        <th>Instrumento</th>
        <th>Método</th>
        <th>Reactivo</th>
        <th>Unidad de Medida</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for prueba in pending_pruebas %}
        {% include "partials/_crear_config_prueba_row.html" with prueba=prueba %}
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>No hay pruebas pendientes.</p>
  {% endif %}

  <hr />

  <!-- Configuraciones aceptadas -->
  <h4>Pruebas configuradas</h4>
  {% if accepted_configs %}
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Prueba</th>
        <th>Instrumento</th>
        <th>Método</th>
        <th>Reactivo</th>
        <th>Unidad</th>
      </tr>
    </thead>
    <tbody>
      {% for config in accepted_configs %}
        {% include "partials/_config_row.html" with config=config %}
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>No hay configuraciones aceptadas.</p>
  {% endif %}

  <hr />

  <!-- Propuestas -->
  <h4>Propuestas de propiedades</h4>
  <div id="propuestas-wrapper">
    {% if propuestas %}
    <table id="tabla-propuestas" class="table table-hover">
      <thead>
        <tr>
          <th>Tipo</th>
          <th>Valor</th>
          <th>Descripción</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="propuestas-body">
        {% for prop in propuestas %}
          {% include "partials/_propuesta_row.html" with prop=prop %}
        {% endfor %}
      </tbody>
    </table>
    {% else %}
      <p id="sin-propuestas">No hay propuestas registradas.</p>
      <table id="tabla-propuestas" class="table table-hover" style="display:none;">
        <thead>
          <tr>
            <th>Tipo</th>
            <th>Valor</th>
            <th>Descripción</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="propuestas-body"></tbody>
      </table>
    {% endif %}
  </div>

</div>
